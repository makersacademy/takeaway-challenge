Takeaway Challenge
==================
```
                            _________
              r==           |       |
           _  //            |  M.A. |   ))))
          |_)//(''''':      |       |
            //  \_____:_____.-------D     )))))
           //   | ===  |   /        \
       .:'//.   \ \=|   \ /  .:'':./    )))))
      :' // ':   \ \ ''..'--:'-.. ':
      '. '' .'    \:.....:--'.-'' .'
       ':..:'                ':..:'

 ```

Brief
-----

* Write a Takeaway program with the following user stories:

## User Stories

So far an implementation of all four of these user stories has been implemented **but** they do not work cohesively together withotu significant user input and there is no feature_spec.rb to demostrate the capabilities.

```
As a customer
So that I can check if I want to order something
I would like to see a list of dishes with prices

As a customer
So that I can order the meal I want
I would like to be able to select some number of several available dishes

As a customer
So that I can verify that my order is correct
I would like to check that the total I have been given matches the sum of the various dishes in my order

As a customer
So that I am reassured that my order will be delivered on time
I would like to receive a text such as "Thank you! Your order was placed and will be delivered before 18:52" after I have ordered
```

## My Approach

- Extracted objects and messages from User Stories
- Diagrammed relationship between 5 objects
  - Takeaway
  - Order
  - Menu
  - Dish
  - TwilioManager
- created dish_spec file to drive development of Dish class
  - added initialize(name, price)
  - add available? predicate method
  - add attr_reader for name and price
  - add set_unavailable and set_available methods -> modifying instance var @available
- created menu_spec file to drive development of Menu class
  - add list_dishes method
    - test with fixed string, then with dish double
  - add add_dish method
    - use dish double to isolate from Dish class
  - add list_available_dishes
    - use multiple dish doubles to test function
- created twiliomanager_spec file to drive development of TwilioManager class
  - ~no active tests to begin with as need to understand usage of Twilio API~
  - added client_exists? to allow checking that a client has been set up without exposing Twilio Client Object (has credentials)
  - used [Twilio example Ruby code](https://www.twilio.com/docs/libraries/ruby) to create send_sms function
  - added test to check for successful sending of sms
- created order_spec file to drive development of Order class
  - add add_to_order method
  - add current_items instance variable and attr_reader
  - add remove_from_order method
  - add order_total_price method
- created takeaway_spec file to drive development of Takeaway class
  - add confirmation_string method
  - add time_in_an_hour method
  - add send_confirmation_text method
- added TimeCop to Gemfile in order to test specific times correctly


## Living Documentation

Generated by using rspec with current test suite

```rs
Dish
  #name
    returns the stored name
  #price
    returns the stored price
  #available?
    defaults to true
  #set_unavailable
    causes available? to return false
  #set_available
    after having been set to set_unavailable
      causes available? to return true

Menu
  #add_dish
    updates the list of items
  #list_dishes
    returns a formatted list of dishes
      with a single dish
      with multiple dishes
  #find_by_name
    returns an item that matches the name given
  #list_available_dishes
    returns a formatted list of available dishes

Order
  #add_to_order
    adds an item to the user's order
  #remove_from_order
    if item is in current order
      removes the item
    if item is not in current order
      raises an error
  order contains three pizzas
    #order_total_price
      returns the sum of the item prices
    #list_order
      prints all items in the order
    #select_items
      when given a valid item
        adds the dish to the order

Takeaway
  #send_confirmation_text
    sends a confirmation text to TwilioManager

TwilioManager
  #initialize
    sets up a new Twilio Client

Finished in 1.77 seconds (files took 0.72895 seconds to load)
18 examples, 0 failures
```

## Credentials File

In order to use this program you will need a Twilio account (free trial available) and once set up you will also need to populate a 'credentials.rb' in the root of the repository with your information. Below is an example.

```
AUTH_TOKEN = Your Twilio Authorization Token (Single-quoted string)
ACCOUNT_SID = Your Twilio Account SID (Single-quoted string)
MESSAGING_SID = The Twilio Messaging service SID (Single-quoted string)
TARGET_PHONE = '+441111111111' (Single-quoted string)
```

## Example Use in IRB

Load `irb` in the root directory then run the following code snippet:

```irb
Dir['lib/*.rb'].each { |file| load file }
dishes = [
  Dish.new('Pizza', 16),
  Dish.new('Sushi', 12),
  Dish.new('Fish & Chips', 9),
  Dish.new('Thai Green Curry', 14),
  Dish.new('Chicken Wings', 7)
]
menu = Menu.new
dishes.each { |dish| menu.add_dish(dish) }
twilio = TwilioManager.new
order = Order.new
takeaway = Takeaway.new(twilio, menu, order)
takeaway.interactive_menu
```

## Technologies Used

- Ruby
- SimpleCov - Test Coverage is currently 91.71%
  - Interactive menu is not currently tested properly (requires mocking of user input)
  - private methods that it relies on do not count as being tested for SimpleCov
- Rubocop
- TimeCop

## Next Steps

- implement a way for users to add multiple dishes at once, instead of dish by dish in the command line
- Fix interactive menu test as currently non-functional with mocked STDIN
  - either exits the entire test suite or gets caught in an infinite loop
- Develop a feature_spec.rb to demostrate the capability of the classes, and then use it to drive more cohesive behaviour for the program as a whole

## Advanced Step

Below is a suggested next step from the brief that I plan to return to once more comfortable with the use of the Twilio API

* Advanced! (have a go if you're feeling adventurous):
  * Implement the ability to place orders via text message.
